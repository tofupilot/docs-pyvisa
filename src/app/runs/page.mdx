export const metadata = {
  title: 'Runs',
  description:
    'On this page, we’ll dive into the different run endpoints you can use to manage runs programmatically.',
}

# Runs

Runs are an essential part of TofuPilot — they are the the primary method for systematically testing and evaluating hardware performance and reliability. On this page, we’ll dive into the different run endpoints you can use to manage runs programmatically. {{ className: 'lead' }}

---

## Create a run {{ tag: 'POST', label: '/v1/runs' }}

<Row>
  <Col>

    This endpoint allows you to register a new run based on a procedure and performed on a unit.

    ## Required attributes

    <Properties>
      <Property name="procedure_id" type="string">
        Unique identifier for the run's procedure.
      </Property>
      <Property name="unit_under_test" type="record">
      - serial_number (string): Serial number of the unit
      - part_number (string): Part number of the unit's component
      - revision (optional, string): Revision of the unit's component. Required if component has more than one revision.
      </Property>
    </Properties>

    ### When using TofuPilot Client

    <Properties>
      <Property name="test_function" type="() => boolean">
        The function executing the test's script. Must return a boolean representing the run's status. Any call to stdout and stderr inside this function will be logged.
      </Property>
    </Properties>

    ### When using REST API

    <Properties>
      <Property name="run_passed" type="boolean">
        Boolean indicating whether the run passed or not.
      </Property>
      <Property name="duration" type="duration">
        ISO8601 timestamp indicating the duration of the run.
      </Property>
    </Properties>

    ## Optional attributes

    <Properties>
      <Property name="sub_units_sn" type="array(string)">
        A list of unit identifiers that should be added as sub-units of the run's unit
      </Property>
      <Property name="params" type="record(string, string)">
        {"A dictionary of key/value pairs used to replace {{smart fields}} in the procedure's document."}
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/v1/runs">

```python
from tofupilot import TofuPilotClient

client = TofuPilotClient(api_key="{token}")

def test_function():
    # Your test execution goes here
    return True

client.create_run(
    procedure_id="FVT1",
    unit_under_test = {
      "part_number": 'EXAMPLE-PART-NUMBER',
      "serial_number": 'EXAMPLE-SERIAL-NUMBER',
    },
    test_function=test_function
)
```

```bash {{ title: 'cURL' }}
curl -X POST https://www.tofupilot.com/api/v1/runs
  -H "Content-Type: application/json"
  -H "Authorization: Bearer {token}"
  -d '{
    "procedure_id": "FVT1",
    "unit_under_test": {
      "part_number": "EXAMPLE-PART-NUMBER",
      "serial_number": "EXAMPLE-SERIAL-NUMBER"
    },
    "run_passed": true,
    "duration": "PT27M15S"
}'
```

```js
fetch('https://www.tofupilot.com/api/v1/runs', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: 'Bearer {token}',
  },
  body: JSON.stringify({
    procedure_id: 'FVT1',
    unit_under_test: {
      part_number: 'EXAMPLE-PART-NUMBER',
      serial_number: 'EXAMPLE-SERIAL-NUMBER',
    },
    run_passed: true,
    duration: 'PT27M15S',
  }),
})
```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "url": "https://tofupilot.com/acme-corp/runs/your-new-run"
    }
    ```

  </Col>
</Row>
