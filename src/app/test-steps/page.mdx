export const metadata = {
  title: 'Steps',
  description: '',
}

# Test Steps

TofuPilot allows you to log steps of your run by adding the `steps` parameter. Below is a code snippet demonstrating how to create a run with test steps:

## Example

```python {{ title: 'create_run_with_steps.py'}}
from tofupilot import TofuPilotClient
from datetime import datetime

client = TofuPilotClient(api_key="Your api key")

def step_boolean_test():
    return True, None, None, None, None

def step_initial_temp_check():
    return True, 72.0, "°C", None, None

def step_temp_calibration():
    return True, 75.0, "°C", 70.0, 80.0

def step_final_temp_check():
    return True, 75.0, "°C", None, None

def run_all_tests():
    tests = [
        func for name, func in globals().items()
        if callable(func) and name.startswith("step_")
    ]
    steps, all_passed = [], True

    for t in tests:
        print(f"Running test: {t.__name__}")
        start = datetime.now()
        passed, value, unit, low, high = t()
        end = datetime.now()
        steps.append(
            {
                "name": t.__name__,
                "started_at": start,
                "duration": end - start,
                "step_passed": passed,
                "measurement_unit": unit,
                "measurement_value": value,
                "limit_low": low,
                "limit_high": high,
            }
        )
        if not passed:
            all_passed = False

    print("Steps executed:")
    for step in steps:
        print(step)

    return all_passed, steps

# Run tests and create run
run_passed, steps = run_all_tests()

client.create_run(
    procedure_id="FVT1",
    unit_under_test={"serial_number": "00119"},
    run_passed=run_passed,
    steps=steps,
)
```

<Note>
  Please note that the provided Python example is designed to be
  framework-agnostic and includes extensive business logic for illustrative
  purposes. In a real-world scenario, it is advisable to utilize a dedicated
  hardware testing framework, such as [OpenHTF](https://openhtf.com), to
  streamline and optimize your implementation.
</Note>

## Run page

You can view the run steps in the ‘Steps’ section of the Run’s page.

<Image src={'/test-steps-run.png'} alt={"Run's steps"} />

## Procedure page

On the Procedure page, you can find a comprehensive summary of the duration and yield of all test steps, including data from all the runs executed from the procedure

<Image src={'/test-steps-procedure.png'} alt={"Procedure's steps"} />

<Note>
  For complete details on the API signature for run steps, please refer to the
  [API documentation page](/runs).
</Note>
