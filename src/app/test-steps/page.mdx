export const metadata = {
  title: 'First Run',
  description:
    'TofuPilot offers a fine-tuned Python library to make your life easier and give you the best experience when consuming the API.',
}

# Create a Run with Test Steps

TofuPilot allows you to log steps of your run by adding the `steps` parameter. Below is a code snippet demonstrating how to create a run with test steps:

  <CodeGroup>

```python
from tofupilot import TofuPilotClient
from datetime import datetime


client = TofuPilotClient(api_key="Your api key")


def initial_temperature_check():
    return True, 72.0, "°C", None, None


def temperature_calibration():
    return True, 75.0, "°C", 70.0, 80.0


def final_temperature_check():
    return True, 75.0, "°C", None, None


def run_all_tests():
    tests = [
        initial_temperature_check,
        temperature_calibration,
        final_temperature_check,
    ]
    steps = []
    all_tests_passed = True

    for test in tests:
        start_time = datetime.now()
        passed, value_measured, unit, min_threshold, max_threshold = test()
        end_time = datetime.now()

        step = {
            "name": test.__name__,
            "started_at": start_time,
            "duration": end_time - start_time,
            "passed": passed,
            "unit": unit,
            "measured_value": value_measured,
            "min_threshold": min_threshold,
            "max_threshold": max_threshold,
        }

        steps.append(step)

        if not passed:
            all_tests_passed = False

    return all_tests_passed, steps


# Run the tests and create the run
run_passed, steps = run_all_tests()

client.create_run(
    procedure_id="FVT1",
    unit_under_test={"serial_number": "0001"},
    run_passed=run_passed,
    steps=steps,
)
```

```js
fetch('https://tofupilot.com/api/v1/runs', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: `Bearer ${yourApiKey}`,
  },
  body: JSON.stringify({
    procedure_id: 'FVT1',
    unit_under_test: {
      serial_number: '00102',
    },
    run_passed: true,
    steps: [
      {
        name: 'Current Consumption',
        started_at: new Date(Date.now() - 240000).toISOString(), // 4 minutes ago
        duration: 'PT1M15S',
        passed: true,
        units: 'Amperes',
        measured_value: 0.5,
        min_threshold: 0.3,
        max_threshold: 0.7,
      },
      {
        name: 'Vibration Test',
        started_at: new Date(Date.now() - 300000).toISOString(), // 5 minutes ago
        duration: 'PT2M30S',
        passed: false,
      },
    ],
  }),
});
```

  </CodeGroup>

<Note>
  Please note that the provided Python example is designed to be framework-agnostic and includes extensive business logic for illustrative purposes. In a real-world scenario, it is advisable to utilize a dedicated hardware testing framework, such as [OpenHTF](https://openhtf.com), to streamline and optimize your implementation.
</Note>

## Check the Run page

You can view the run steps in the ‘Steps’ section of the Run’s page.

<Image src={'/test-steps-run.png'} alt={"Run's steps"} />

## Check the Procedure page

On the Procedure page, you can find a comprehensive summary of the duration and yield of all test steps, including data from all the runs executed from the procedure

<Image src={'/test-steps-procedure.png'} alt={"Procedure's steps"} />

<Note>
  For complete details on the API signature for run steps, please refer to the [API documentation page](/runs).
</Note>
